<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Career Information</title>
  <link rel="stylesheet" href="../css/career-info.css" />
  <link rel="stylesheet" href="../css/career-icon.css" />
  <!-- Material Symbols -->
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
    rel="stylesheet"
  />
</head>
<body>
  <header class="resume-header">
    <div class="logo">
      <a href="../index.html">
        <img src="../assets/logo.png" class="nav_img_logo" alt="SkillVora Logo" />
      </a>
    </div>
  </header>

  <div class="container">
    <div class="header">
      <div class="breadcrumb">
      <a href="suggestion.html">Suggested Careers></a><span id="careerBreadcrumb"></span>
      </div>
      <button class="back-btn" onclick="window.location.href='suggestion.html'">
        <span class="material-symbols-outlined back-icon">arrow_back</span>
        Back to suggestions
      </button>
    </div>

    <div class="hero">
      <div class="hero-image">
        <!-- Career image container -->
        <div class="career-icon">
          <img id="careerImage" src="" alt="">
        </div>
      </div>
      <div class="hero-content">
        <h1 id="careerTitle"></h1>
        <p id="careerDescription"></p>
      </div>
    </div>

    <div class="content">
      <div class="section">
        <h2>About the role</h2>
        <div id="careerRoles"></div>
      </div>

      <div class="section">
        <h2>Key Skills & Qualifications</h2>
        <div class="skills" id="careerSkills"></div>
      </div>

      <div class="section">
        <h2>Requirements</h2>
        <div id="careerRequirements"></div>
      </div>
    </div>
  </div>
</body>

<script>
  // Get selected career from localStorage
  const careerStr = localStorage.getItem("selectedCareer");
  if (!careerStr) {
    alert("No career selected. Redirecting to suggestions page.");
    window.location.href = "suggestion.html";
  }

  const career = JSON.parse(careerStr);
  const userType = localStorage.getItem("userType"); // "SPM Leavers" or "Job Seeker"

  // Set breadcrumb, title, description
  document.getElementById("careerBreadcrumb").textContent = career.title;
  document.getElementById("careerTitle").textContent = career.title;
  document.getElementById("careerDescription").textContent = career.description;

  // Set image
  const img = document.getElementById("careerImage");
  img.src = career.image;
  img.alt = career.title;

  // Populate roles
  const rolesContainer = document.getElementById("careerRoles");
  (career.roles || []).forEach(role => {
    const item = document.createElement("div");
    item.className = "role-item";
    item.innerHTML = `<div class="checkmark"></div><p>${role}</p>`;
    rolesContainer.appendChild(item);
  });

  // Populate skills
  const skillsContainer = document.getElementById("careerSkills");
  (career.skills || []).forEach(skill => {
    const tag = document.createElement("div");
    tag.className = "skill-tag";
    tag.textContent = skill;
    skillsContainer.appendChild(tag);
  });

  // Populate requirements
  const requirementsContainer = document.getElementById("careerRequirements");

  function renderRequirements(career, userType) {
        /* ---- SPM LEAVERS ---- */
        if (userType === "SPM Leavers" && career.spm) {
          const req = career.spm;
          return `
            <div class="requirements">
              <h4>SPM Requirements</h4>
              <p><strong>Minimum Qualification:</strong> 
                <span class="qualification-tag">Diploma / Degree</span>
              </p>
              <ul class="subjects">
                ${req.subjects
                  .map(sub => `
                    <li>
                      <span class="subject-name">${sub.name}</span>
                      <span class="subject-grade">${sub.grade}</span>
                    </li>`).join("")}
              </ul>
              <p class="notes">${req.notes}</p>
            </div>
          `;
        }

        /* ---- JOB SEEKERS ---- */
        if (career.jobSeeker) {
          const jobReq = career.jobSeeker;
          // Show only first 2 courses
          const allCourses = jobReq.courses;

          return `
            <div class="requirements">
              <h4>Career Requirements</h4>
              <p><strong>Minimum Qualification:</strong> 
                <span class="qualification-tag">Diploma / Degree</span>
              </p>
              <p><strong>Recommended Course(s):</strong></p>
              <ul class="subjects">
                ${allCourses.map(course => `<li>${course}</li>`).join("")}
              </ul>
              <p class="notes">${jobReq.notes}</p>
            </div>
          `;
        }

        return "";
      }


  requirementsContainer.innerHTML = renderRequirements(career, userType);
  src="../js/theme-toggle.js"
</script>
