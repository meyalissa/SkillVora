<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Suggested Careers</title>
    <link rel="stylesheet" href="../css/suggest.css" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
    <script src="../js/careerData.js"></script>
  </head>
  <body>
    <header class="resume-header">
      <div class="logo">
        <a href="../index.html">
          <img
            src="../assets/logo.png"
            class="nav_img_logo"
            alt="SkillVora Logo"
          />
        </a>
      </div>
    </header>

    <div class="container">
      <h2>Suggested Careers</h2>
      <div class="careers-grid" id="careersGrid"></div>
    </div>

    <script>
      /* User selection */
      function getUserSelection() {
        return {
          interest: localStorage.getItem("interest"),
          background: localStorage.getItem("background"),
          skills: JSON.parse(localStorage.getItem("skills")) || [],
        };
      }

      /* Score career - console*/
      function scoreCareers() {
        const user = getUserSelection();
        const selectedSkills = user.skills.slice(0, 3); // exactly 3 skills

        return careerData.map(career => {
          let score = 0;

          if (career.interests.includes(user.interest)) score += 3;
          if (career.backgrounds.includes(user.background)) score += 2;

          selectedSkills.forEach(skill => {
            if (career.skills.includes(skill)) score += 1;
          });

          console.log(`Career: ${career.title} | Score: ${score}`);
          return { ...career, score };
        });
      }

      /* Display 3 career*/
      function displayCareers() {
        const grid = document.getElementById("careersGrid");

        const careers = scoreCareers()
          .filter(career => career.score > 0)
          .sort((a, b) => b.score - a.score)
          .slice(0, 3); // show top 3

        grid.innerHTML = "";

        if (careers.length === 0) {
          grid.innerHTML = "<p>No careers match your selection.</p>";
          return;
        }

        careers.forEach(career => {
          const card = document.createElement("div");
          card.className = "career-card";

          card.innerHTML = `
          <div class="career-icon">
            <img src="${career.image}" alt="${career.name}" />
          </div>
          <h3 class="career-title">${career.title}</h3>
          <p class="career-description">${career.description}</p>
          <div class="skills">
            ${career.skills
              .map((skill) => `<span class="skill-tag">${skill}</span>`)
              .join("")}
          </div>
          <div class="requirements">
          <h4>Requirements</h4>
          <p class="education">
            <strong>Education:</strong> ${career.requirements.education}
          </p>
          <ul class="subjects">
            ${career.requirements.subjects.map(sub =>
              `<li>
                <span class="subject-name">${sub.name}</span>
                <span class="subject-grade">${sub.grade}</span>
              </li>`
            ).join("")}
          </ul>
          <p class="notes">${career.requirements.notes}</p>
        </div>
        <button class="view-details-btn">View Details</button>
      `;

          // view detail button
          card
            .querySelector(".view-details-btn")
            .addEventListener("click", () => {
              localStorage.setItem("selectedCareer", JSON.stringify(career));
              window.location.href = "career-information.html";
            });

          grid.appendChild(card);
        });
      }

      document.addEventListener("DOMContentLoaded", displayCareers);
    </script>
  </body>
</html>
